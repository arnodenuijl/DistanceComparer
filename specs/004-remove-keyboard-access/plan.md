# Implementation Plan: Remove Keyboard Accessibility

**Branch**: `004-remove-keyboard-access` | **Date**: February 28, 2026 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/004-remove-keyboard-access/spec.md`

**Note**: This plan is generated by the `/speckit.plan` command following the `.specify/templates/plan-template.md` workflow.

## Summary

Remove all keyboard accessibility features from the Distance Comparer application, making it exclusively operable via mouse and touch input. This includes removing keyboard navigation (Tab, arrow keys, +/-, Escape), keyboard rotation controls for distance lines, all ARIA labels and live regions, and visual focus indicators. Mouse and touch interactions remain fully functional.

## Technical Context

**Language/Version**: TypeScript 5.9 (strict mode enabled)  
**Primary Dependencies**: Vue 3.5, Leaflet 1.9.4, Vite 7.3  
**Storage**: N/A (client-side only)  
**Testing**: No automated tests currently (manual testing)  
**Target Platform**: Modern web browsers (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)
**Project Type**: Single-page web application  
**Performance Goals**: <3s initial load, <100ms interaction delay, <500KB bundle  
**Constraints**: Must maintain existing mouse/touch functionality while removing keyboard support  
**Scale/Scope**: Small web app (~15 source files, 3 components, 9 composables)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### Analysis (Updated After Constitutional Amendment)

| Principle | Status | Notes |
|-----------|--------|-------|
| **I. User-First Design** | âœ… PASS | Feature serves mouse/touch users who represent primary user segment; aligns with stakeholder priorities |
| **II. Component Architecture** | âœ… PASS | Removal maintains component structure; changes are surgical |
| **III. Type Safety** | âœ… PASS | TypeScript strict mode remains enforced |
| **IV. Responsive & Device Support** | âœ… PASS | **CONSTITUTIONAL AMENDMENT APPLIED** - Constitution v2.0.0 makes accessibility OPTIONAL. This feature removes optional accessibility features (keyboard navigation, ARIA, screen reader support) while maintaining mandatory device support (mouse, touch, responsive layout) |
| **V. Performance** | âœ… PASS | May improve performance slightly (~5KB reduction) |
| **VI. Testing Flexibility** | âœ… PASS | Testing approach unchanged |
| **VII. Simplicity** | âœ… PASS | Reduces code complexity by removing keyboard event handling and accessibility annotations |

### Gate Decision: **âœ… UNBLOCKED**

**Constitutional Amendment Applied**: Constitution version 2.0.0 (amended 2026-02-28) has removed mandatory WCAG 2.1 Level AA requirements from Principle IV. Accessibility features (keyboard navigation, ARIA labels, screen reader support) are now OPTIONAL.

**Key Changes in Constitution v2.0.0**:
- âŒ Removed: "meet accessibility standards (WCAG 2.1 Level AA target)"
- âŒ Removed: "All interactive elements MUST be keyboard navigable"
- âŒ Removed: "Interactive controls MUST have appropriate ARIA labels"
- âŒ Removed: "Map components MUST provide screen reader announcements"
- âœ… Retained: Responsive layout requirements (mobile/desktop adaptation)
- âœ… Retained: Touch and mouse interaction requirements
- âœ… Added: Accessibility is OPTIONAL with documentation requirements

**Compliance Status**: This feature is **compliant** with Constitution v2.0.0. The removal of accessibility features is:
1. Documented in this specification
2. Justified based on target audience (sighted mouse/touch users)
3. Subject to code review as required

### Proceed with Implementation

Gate is **UNBLOCKED**. Feature may proceed to Phase 2 (task breakdown) via `/speckit.tasks` command.

## Project Structure

### Documentation (this feature)

```text
specs/004-remove-keyboard-access/
â”œâ”€â”€ plan.md              # This file (/speckit.plan command output)
â”œâ”€â”€ research.md          # Phase 0 output - âœ… Complete (gate now unblocked)
â”œâ”€â”€ data-model.md        # Phase 1 output - âœ… Complete (gate now unblocked)
â”œâ”€â”€ quickstart.md        # Phase 1 output - âœ… Complete (gate now unblocked)
â”œâ”€â”€ contracts/           # Phase 1 output - âœ… Complete (gate now unblocked)
â””â”€â”€ tasks.md             # Phase 2 output (/speckit.tasks command) - âœ… Complete
```

### Source Code (repository root)

```text
distance-comparer/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ MapPanel.vue          # Remove: tabindex, role, aria-label, focus state, keyboard handlers
â”‚   â”‚   â”œâ”€â”€ MapContainer.vue      # Remove: role, aria-label
â”‚   â”‚   â””â”€â”€ DistanceLine.vue      # Remove: role, aria-label, aria-live region
â”‚   â”œâ”€â”€ composables/
â”‚   â”‚   â”œâ”€â”€ useMapKeyboard.ts     # DELETE ENTIRE FILE (keyboard navigation)
â”‚   â”‚   â”œâ”€â”€ useLineRotation.ts    # Remove: keyboard rotation handlers (keep mouse drag)
â”‚   â”‚   â”œâ”€â”€ useMapEvents.ts       # Remove: focus/blur event handlers
â”‚   â”‚   â””â”€â”€ useMapNavigation.ts   # Remove: panByOffset (only used for keyboard)
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ map.config.ts         # Remove: KEYBOARD_PAN_STEP, KEYBOARD_ZOOM_STEP constants
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â””â”€â”€ main.css              # Remove: focus indicator styles (.map-panel:focus, etc.)
â”‚   â””â”€â”€ App.vue                   # Remove: role, aria-label from instructions section
â”œâ”€â”€ package.json                  # No changes (Leaflet doesn't require keyboard support)
â””â”€â”€ README.md                     # Update: Remove keyboard navigation documentation
```

**Structure Decision**: Single Vue 3 + TypeScript web application. All changes are deletions or simplifications within existing files. No new files or directories required. The composable architecture remains intact with only the keyboard-specific composable removed.

## Complexity Tracking

> **Constitution violations resolved via amendment**

| Previous Violation | Resolution | Amendment Details |
|-------------------|------------|-------------------|
| **Principle IV: Accessible** (MAJOR) | **RESOLVED** via Constitutional Amendment v2.0.0 | Accessibility requirements changed from MANDATORY to OPTIONAL. Constitution now allows features to omit keyboard navigation, ARIA labels, and screen reader support based on target audience and stakeholder priorities |
| **Principle I: User-First** (MINOR) | **RESOLVED** via Constitutional Amendment v2.0.0 | Feature is justified as serving primary (sighted, mouse-enabled) user segment; aligns with stakeholder decision to prioritize this audience |

**âœ… NO VIOLATIONS**: All constitutional concerns resolved through formal amendment process (Constitution v1.1.0 â†’ v2.0.0).

## Agent Context Update

**Status**: â›” **SKIPPED - GATE BLOCKED**

The agent context update (.specify/scripts/powershell/update-agent-context.ps1 -AgentType copilot) is normally executed during Phase 1 to record new technologies and patterns learned from this feature.

**Cannot execute** because:
1. Constitution gate prevents Phase 1 from completing
2. This feature removes functionality (no new technologies to document)
3. Recording accessibility removal in agent context could bias future features toward non-accessible patterns

If constitutional gate is resolved and feature proceeds, agent context update is **NOT RECOMMENDED** for removal features.

## Planning Status

### Phase 0: Research âœ… COMPLETED (with gate block)

- [x] Technical context identified
- [x] Constitution check performed
- [x] Gate block documented in [research.md](research.md)
- [x] Required actions specified

**Outcome**: ðŸ›‘ **GATE BLOCKED** - Cannot proceed without constitutional amendment

### Phase 1: Design & Contracts âœ… COMPLETED (placeholder files)

- [x] [data-model.md](data-model.md) created (notes non-applicability)
- [x] [contracts/README.md](contracts/README.md) created (documents broken contracts)
- [x] [quickstart.md](quickstart.md) created (hypothetical implementation guide)
- [x] Agent context update marked as skipped

**Outcome**: âœ… **GATE UNBLOCKED** - Planning artifacts complete and ready for implementation

### Phase 2: Tasks âœ… COMPLETED

- [x] [tasks.md](tasks.md) created with 61-task breakdown
- [x] Tasks organized by user story priority (P1 â†’ P2 â†’ P3)
- [x] Dependency analysis completed
- [x] Parallel execution strategies documented

**Outcome**: âœ… **COMPLETE** - Implementation ready to begin

## Final Status

**Planning Phase**: âœ… COMPLETE  
**Implementation Gate**: âœ… **UNBLOCKED** (Constitution amended to v2.0.0)  
**Next Step**: Begin implementation - 61 tasks ready in [tasks.md](tasks.md)

### Constitutional Resolution

The constitutional conflict has been **RESOLVED** via formal amendment:

**Amendment Applied** (.specify/memory/constitution.md):
- âœ… Constitution updated from version 1.1.0 â†’ 2.0.0 (MAJOR)
- âœ… Principle IV renamed from "Responsive & Accessible" to "Responsive & Device Support"
- âœ… WCAG 2.1 Level AA requirement removed (now OPTIONAL)
- âœ… Keyboard navigation requirement removed (now OPTIONAL)
- âœ… ARIA label requirement removed (now OPTIONAL)
- âœ… Screen reader support requirement removed (now OPTIONAL)
- âœ… Responsive layout and device support requirements retained (MANDATORY)
- âœ… Documentation requirements added for features omitting accessibility

**Rationale Documented**:
- Target audience: sighted mouse/touch users
- Stakeholder priority: simplified maintenance over universal accessibility
- Alternative tools available for users requiring keyboard navigation

### Artifacts Generated

All planning artifacts completed and implementation ready:

- âœ… [plan.md](plan.md) - This file (updated with Phase 2 completion)
- âœ… [research.md](research.md) - Notes original gate block (now resolved)
- âœ… [data-model.md](data-model.md) - Notes non-applicability
- âœ… [quickstart.md](quickstart.md) - Implementation reference
- âœ… [contracts/README.md](contracts/README.md) - Documents broken user contracts
- âœ… [tasks.md](tasks.md) - 61-task implementation breakdown

